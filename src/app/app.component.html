<!--The content below is only a placeholder and can be replaced.-->

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<div *ngIf="done" id="HeadContainer">
  <img width="220" class="header1" alt="Powered by Strava" src="data:image/svg+xml;base64,PHN2ZyBpZD0ic3RyYXZhX291dGxpbmVkIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNjIuMDIgMzAuMjEiPjxkZWZzPjxzdHlsZT4uY2xzLTF7ZmlsbDojZmM0YzAyO30uY2xzLTJ7ZmlsbDojOTk5O308L3N0eWxlPjwvZGVmcz48dGl0bGU+YXBpX2xvZ288L3RpdGxlPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTgxLjM0LDIyLjk0QTE0LjE1LDE0LjE1LDAsMCwxLDc3LDIyLjNhOS41NCw5LjU0LDAsMCwxLTMuNDQtMS45MWwyLjctMy4yMWE4LDgsMCwwLDAsMi41OSwxLjM2LDkuMzEsOS4zMSwwLDAsMCwyLjcuNDEsMi4xMywyLjEzLDAsMCwwLDEtLjE3LDAuNTMsMC41MywwLDAsMCwuMy0wLjQ3djBhMC42MywwLjYzLDAsMCwwLS40NC0wLjU0LDcuNjksNy42OSwwLDAsMC0xLjY1LS40NXEtMS4yNy0uMjYtMi40My0wLjYxYTguMzUsOC4zNSwwLDAsMS0yLS44OCw0LjI3LDQuMjcsMCwwLDEtMS4zOS0xLjM2LDMuNjksMy42OSwwLDAsMS0uNTItMnYwYTQuNzgsNC43OCwwLDAsMSwuNDItMiw0LjU3LDQuNTcsMCwwLDEsMS4yMy0xLjYyLDUuODUsNS44NSwwLDAsMSwyLTEuMDgsOC45LDguOSwwLDAsMSwyLjc1LS4zOSwxMi44NywxMi44NywwLDAsMSwzLjg1LjUyLDkuMTgsOS4xOCwwLDAsMSwzLDEuNTVsLTIuNDYsMy40MWE3LjU3LDcuNTcsMCwwLDAtMi4yOC0xLjEzLDcuOTMsNy45MywwLDAsMC0yLjI2LS4zNiwxLjU2LDEuNTYsMCwwLDAtLjgzLjE3LDAuNTEsMC41MSwwLDAsMC0uMjcuNDV2MGEwLjYyLDAuNjIsMCwwLDAsLjQxLjUyLDcsNywwLDAsMCwxLjYuNDUsMjIuMzcsMjIuMzcsMCwwLDEsMi42NC42Miw3LjgsNy44LDAsMCwxLDIsLjk0LDQuMTYsNC4xNiwwLDAsMSwxLjMyLDEuMzdBMy44MSwzLjgxLDAsMCwxLDg4LDE3Ljc4djBBNC42OSw0LjY5LDAsMCwxLDg3LjU0LDIwYTQuNTcsNC41NywwLDAsMS0xLjM0LDEuNjEsNi4zNSw2LjM1LDAsMCwxLTIuMDksMUE5Ljg3LDkuODcsMCwwLDEsODEuMzQsMjIuOTRaIi8+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNOTIuMTgsMTEuODJIODcuNzNWNy41NWgxMy45NXY0LjI3SDk3LjIzVjIyLjY2SDkyLjE4VjExLjgyWiIvPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTEwMi4zOSw3LjU1aDcuMzhBMTAuMSwxMC4xLDAsMCwxLDExMy4xLDhhNS41NCw1LjU0LDAsMCwxLDIuMSwxLjI2LDQuNjEsNC42MSwwLDAsMSwxLDEuNTUsNS40OCw1LjQ4LDAsMCwxLC4zNSwydjBhNC43Nyw0Ljc3LDAsMCwxLS44LDIuOCw1LjUsNS41LDAsMCwxLTIuMTgsMS44MWwzLjUyLDUuMTRoLTUuNzZsLTIuODUtNC4zMmgtMS4wOHY0LjMyaC01LjA1VjcuNTVabTcuMjMsNy4xOWEyLjMyLDIuMzIsMCwwLDAsMS40Mi0uMzksMS4yOCwxLjI4LDAsMCwwLC41Mi0xLjA4djBhMS4yMywxLjIzLDAsMCwwLS41Mi0xLjA5LDIuNDQsMi40NCwwLDAsMC0xLjQtLjM2aC0yLjJ2M2gyLjE4WiIvPjxwb2x5Z29uIGNsYXNzPSJjbHMtMSIgcG9pbnRzPSIxNDYuMzQgMTYuMTYgMTQ5LjYzIDIyLjY2IDE1NC40NyAyMi42NiAxNDYuMzQgNi42MSAxMzguMiAyMi42NiAxNDMuMDQgMjIuNjYgMTQ2LjM0IDE2LjE2Ii8+PHBvbHlnb24gY2xhc3M9ImNscy0xIiBwb2ludHM9IjEyMy43IDE2LjE2IDEyNi45OSAyMi42NiAxMzEuODMgMjIuNjYgMTIzLjcgNi42MSAxMTUuNTggMjIuNjYgMTIwLjQxIDIyLjY2IDEyMy43IDE2LjE2Ii8+PHBvbHlnb24gY2xhc3M9ImNscy0xIiBwb2ludHM9IjEzNS4wMiAxNC4wNSAxMzEuNzMgNy41NSAxMjYuODkgNy41NSAxMzUuMDIgMjMuNjEgMTQzLjE1IDcuNTUgMTM4LjMxIDcuNTUgMTM1LjAyIDE0LjA1Ii8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNNy41NSwyMi44VjE2LjVoMi41MWEyLjI1LDIuMjUsMCwwLDEsMS41Ni41MywxLjg1LDEuODUsMCwwLDEsLjU5LDEuNDYsMS44NiwxLjg2LDAsMCwxLS41OCwxLjQ0LDIuMjMsMi4yMywwLDAsMS0xLjU3LjUzSDguNjFWMjIuOEg3LjU1Wm0xLjA2LTMuMzJIMTBhMS4xNCwxLjE0LDAsMCwwLC43Ny0wLjI3LDEsMSwwLDAsMCwwLTEuNDlBMS4yMywxLjIzLDAsMCwwLDEwLDE3LjQ4SDguNjF2MloiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0xNy4xMSwyMi43NWEyLjc0LDIuNzQsMCwwLDEtMSwuMTgsMi43LDIuNywwLDAsMS0xLS4xOSwyLjUsMi41LDAsMCwxLTEuNDgtMS42Miw0Ljc1LDQuNzUsMCwwLDEtLjIzLTEuNTMsMy4zMywzLjMzLDAsMCwxLC44LTIuMzgsMi41NSwyLjU1LDAsMCwxLDEuOTItLjg1LDIuNTIsMi41MiwwLDAsMSwxLjkuODUsMy4zNiwzLjM2LDAsMCwxLC44LDIuMzksNC43NSw0Ljc1LDAsMCwxLS4yMywxLjUzLDIuNjMsMi42MywwLDAsMS0uNjEsMUEyLjUzLDIuNTMsMCwwLDEsMTcuMTEsMjIuNzVabS0yLjE3LTEuMzdhMS40NiwxLjQ2LDAsMCwwLDIuMzIsMCwyLjg5LDIuODksMCwwLDAsLjQ1LTEuNzgsMi42NCwyLjY0LDAsMCwwLS40Ni0xLjY3LDEuNDMsMS40MywwLDAsMC0yLjI5LDAsMi42MiwyLjYyLDAsMCwwLS40NiwxLjY3QTIuODgsMi44OCwwLDAsMCwxNC45NCwyMS4zOFoiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0yMS4yMiwyMi44TDIwLDE2LjVIMjEuMUwyMiwyMC45M2gwbDEuNDktNC40NGgwLjZsMS40OSw0LjQ0aDBsMC44Ni00LjQ0aDEuMDZsLTEuMjEsNi4zSDI1LjE3bC0xLjQyLTQuMzJoMEwyMi4zNCwyMi44SDIxLjIyWiIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTI5LjI0LDIyLjhWMTYuNWgzLjkydjFIMzAuM1YxOS4xaDIuNjFWMjBIMzAuM3YxLjc3aDIuODZ2MUgyOS4yNFoiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0zNS4xNSwyMi44VjE2LjVoMi41MWEyLjI4LDIuMjgsMCwwLDEsMS41Ni41MiwyLjA2LDIuMDYsMCwwLDEsLjIxLDIuNjMsMS45LDEuOSwwLDAsMS0xLC42NGwxLjM2LDIuNTFIMzguNThsLTEuMjgtMi40MmgtMS4xVjIyLjhIMzUuMTVabTEuMDYtMy4zNGgxLjM3YTEsMSwwLDEsMCwwLTJIMzYuMjF2MloiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik00MS41NiwyMi44VjE2LjVoMy45MnYxSDQyLjYzVjE5LjFoMi42MVYyMEg0Mi42M3YxLjc3aDIuODZ2MUg0MS41NloiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik00Ny40NywyMi44VjE2LjVoMi4wNmEyLjczLDIuNzMsMCwwLDEsMSwuMTksMi42NywyLjY3LDAsMCwxLC44Ni41NiwyLjU3LDIuNTcsMCwwLDEsLjYyLDEsNCw0LDAsMCwxLC4yMywxLjQxLDQuMzksNC4zOSwwLDAsMS0uMjMsMS41LDIuMzEsMi4zMSwwLDAsMS0uNjQsMSwyLjY4LDIuNjgsMCwwLDEtLjg4LjUxLDMuMTcsMy4xNywwLDAsMS0xLC4xNmgtMlptMS4wNi0xaDAuOTNhMS41OCwxLjU4LDAsMCwwLDEuMjMtLjQ4LDIuNTQsMi41NCwwLDAsMCwuNDQtMS43QTIuNTMsMi41MywwLDAsMCw1MC42OCwxOGExLjQ0LDEuNDQsMCwwLDAtMS4xNy0uNTNoLTF2NC4zNFoiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik01NywyMi44VjE2LjVoMi41OWExLjg2LDEuODYsMCwwLDEsMS4zNC40OCwxLjU4LDEuNTgsMCwwLDEsLjUsMS4xOSwxLjMyLDEuMzIsMCwwLDEtLjczLDEuMjF2MGExLjc5LDEuNzksMCwwLDEsLjY4LjU0LDEuNDYsMS40NiwwLDAsMSwuMjguOTJxMCwxLjkzLTIuMzEsMS45M0g1N1pNNTgsMTkuMDhoMS4zOWExLjA2LDEuMDYsMCwwLDAsLjY5LTAuMiwwLjcyLDAuNzIsMCwwLDAsLjI0LTAuNTksMC43NCwwLjc0LDAsMCwwLS4yNS0wLjYsMS4wNiwxLjA2LDAsMCwwLS43LTAuMjFINTh2MS42Wm0wLDIuNzRoMS41OEExLjg5LDEuODksMCwwLDAsNjAsMjEuNzRhMC43NywwLjc3LDAsMCwwLC4zMi0wLjE1LDAuOCwwLjgsMCwwLDAsLjE5LTAuMjgsMS4wNiwxLjA2LDAsMCwwLC4wOC0wLjQ0LDAuNzQsMC43NCwwLDAsMC0uMzUtMC43M0EyLjQzLDIuNDMsMCwwLDAsNTkuMTgsMjBINTh2MS44NVoiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik02NC41NywyMi44VjIwLjE0TDYyLjUxLDE2LjVoMS4xM2wxLjQ0LDIuNjhoMGwxLjQ1LTIuNjhoMS4xM2wtMi4wNiwzLjY1VjIyLjhoLTFaIi8+PC9zdmc+">
  <div class="header2">
  {{w1.name}}: {{w1.act.time}}, {{w1.act.distance}} km<br>
  {{w1.dayTime}}
  </div>
  <button class="header3" mat-icon-button (click)="onClickSettings()">
      <mat-icon aria-label="Settings">settings</mat-icon>
  </button>
</div>

<style>
   img {
      vertical-align:top;
      text-align: right;
   }

  .header1,
  .header3 {
      vertical-align: top;
      display: inline-block;
      *display: inline;
      zoom: 1
  }

  .header2 {
      text-align:: middle;
      display: inline-block;
      *display: inline;
      zoom: 1
  }

  #HeadContainer {
    display: flex;
    justify-content: space-between;
  }

  #wrapper { position: relative; }
  #google_map { height : 100vh }
  #over_map { 
    position: absolute; top: 5px; left: 5px; z-index: 99; 
    width:90%; 
    height:90%;
    background-color: #fff;
    padding: 5px;
    border: 1px solid #999;
    text-align: center;
    font-family: 'Roboto','sans-serif';
    line-height: 30px;
  }
  #infos { position: absolute; }

  .stretch {
    width: 100%;
    display: inline-block;
    font-size: 0;
    line-height: 0
  }

  .win {
      position: fixed;
      background-color: white;
      opacity: 1;
      font-family: 'Roboto','sans-serif';
      border: 2px solid #999;
      padding: 5px;
      line-height: 30px;
  }
  .win-corner-resize {
      position: absolute;
      width: 10px;
      height: 10px;
      cursor: all-scroll;
  }
  #win-top-left-resize { top: 0px; left: 0px; }
  #win-top-right-resize { top: 0px; right: 0px; }
  #win-bottom-left-resize { bottom: 0px; left: 0px; }
  #win-bottom-right-resize { bottom: 0px; right: 0px; }

  ::ng-deep .mat-checkbox .mat-checkbox-frame {
    border-color: violet;
  }

  ::ng-deep .mat-checkbox-checked .mat-checkbox-background {
    background-color: darkcyan !important;
  }

  .charts {
      width: 100%;
      height: 100%;
      margin: 0px;
      border: 4px;
      overflow: hidden; /*  Disable scrollbars */
      position: absolute;
    }

</style>

<div id="wrapper" fxLayout="column">
   <div *ngIf="done" id="google_map" fxFlex="1 1 100%" #google_map>
    <agm-map #AgmMap [style.height.px]="google_map.offsetHeight" [latitude]="lat" [longitude]="lng" (mapReady)="fitToScreen($event)">
      <ng-container *ngIf="done">
           <agm-polyline *ngFor="let point of w1.gpsCoord;let i = index;"  [strokeColor]="point.speed < 11 ? '#2196f3': 'red'"i>
              <agm-polyline-point [latitude]="point.gps_lat" [longitude]="point.gps_long">
              </agm-polyline-point>
              <ng-container *ngIf="w1.gpsCoord[i+1]">
                <agm-polyline-point [latitude]="w1.gpsCoord[i+1].gps_lat" [longitude]="w1.gpsCoord[i+1].gps_long">
                </agm-polyline-point>
              </ng-container>
          </agm-polyline>
          <agm-marker 
            *ngFor="let m of w1.lap; let i = index"
            (markerClick)="clickedMarker(m.label, i)"
            [latitude]="w1.gpsCoord[m.lap_start].gps_lat"
            [longitude]="w1.gpsCoord[m.lap_start].gps_long"
            [label]="(m.lap_index-1).toString()">
            <agm-info-window>
              <strong *ngIf="i < 1"> Dist: 0 m<br>Time: 00:00:00<br></strong>
              <strong *ngIf="(i >= 1) && (i < lapSize)"> Dist: {{w1.lap[i-1].lap_distance}} m<br>Time: {{w1.lap[i-1].lap_time}}<br></strong>
            </agm-info-window>
          </agm-marker>
          <agm-marker *ngIf="w1.lap[lapSize-1].lap_end_index"
            [latitude]="w1.gpsCoord[w1.lap[lapSize-1].lap_end].gps_lat"
            [longitude]="w1.gpsCoord[w1.lap[lapSize-1].lap_end].gps_long"
            [label]="(lapSize).toString()">
            <agm-info-window>
              <strong>Dist: {{w1.lap[lapSize-1].lap_distance}} m<br>Time: {{w1.lap[lapSize-1].lap_time}}<br></strong>
            </agm-info-window>
          </agm-marker>
      </ng-container>
    </agm-map>
   </div>
   <div id='settings' *ngIf="showSettings"
                   [style.top.px]='winSettings.y'
                   [style.left.px]='winSettings.x'
                   [style.width.px]='winSettings.width'
                   [style.height.px]='winSettings.height'
                   class='win'>
      <section class="checkButtons">
        <mat-checkbox  class="mycheckbox" (change)="showLaps = !showLaps"
                       [(checked)]="showLaps">Show Laps
        </mat-checkbox>
        <mat-checkbox  class="mycheckbox" (change)="showTrends = !showTrends"
                       [(checked)]="showTrends">Show Trends
        </mat-checkbox>
      </section>
   </div>
   <div id='laps' *ngIf="showLaps"
                   [style.top.px]='winLap.y'
                   [style.left.px]='winLap.x'
                   [style.width.px]='winLap.width'
                   [style.height.px]='winLap.height'
                   (mousedown)='winLap.onWindowPress($event,1)'
                   (mousemove)='winLap.onWindowDrag($event,1)'
                   class='win'>
        <div (mousedown)='winLap.onCornerClick($event, winLap.topLeftResize)' id='win-top-left-resize' class='win-corner-resize'></div>    
        <div (mousedown)='winLap.onCornerClick($event, winLap.topRightResize)' id='win-top-right-resize' class='win-corner-resize'></div>    
        <div (mousedown)='winLap.onCornerClick($event, winLap.bottomLeftResize)' id='win-bottom-left-resize' class='win-corner-resize'></div>    
        <div (mousedown)='winLap.onCornerClick($event, winLap.bottomRightResize)' id='win-bottom-right-resize' class='win-corner-resize'></div> 
        <app-table *ngIf="w1" [wkt]="w1" 
              (lapSelected)="onLapSelected($event)"
              (lapInfos)="onLapInfos($event)">
        </app-table> 

   </div> 
   <div id='trends' *ngIf="showTrends"
                   [style.top.px]='winTrends.y'
                   [style.left.px]='winTrends.x'
                   [style.width.px]='winTrends.width'
                   [style.height.px]='winTrends.height'
                   (mousedown)='winTrends.onWindowPress($event,1)'
                   (mousemove)='winTrends.onWindowDrag($event,1)'
                   class='win'>
        <div (mousedown)='winTrends.onCornerClick($event, winTrends.topLeftResize)' id='win-top-left-resize' class='win-corner-resize'></div>    
        <div (mousedown)='winTrends.onCornerClick($event, winTrends.topRightResize)' id='win-top-right-resize' class='win-corner-resize'></div>    
        <div (mousedown)='winTrends.onCornerClick($event, winTrends.bottomLeftResize)' id='win-bottom-left-resize' class='win-corner-resize'></div>    
        <div (mousedown)='winTrends.onCornerClick($event, winTrends.bottomRightResize)' id='win-bottom-right-resize' class='win-corner-resize'></div> 

          <jqxChart #myChart *ngIf="done"
            (onClick)="chartEvent($event)" (onToggle)="chartEvent($event)"
            (mouseleave)="chartEvent($event)" (mouseenter)="chartEvent($event)" 
              [width]="winTrends.width" [height]="winTrends.height"
              [title]="'Trends'"
              [description]="'whole workout'"
              [showLegend]="true" [padding]="padding"
              [enableCrosshairs]="true" 
              [crosshairsDashStyle]="'1,2'" [crosshairsLineWidth]="'3'" [crosshairsColor]="'#888888'" 
              [titlePadding]="titlePadding" [source]="hrData" [xAxis]="xAxis"
              [seriesGroups]="seriesGroups" [colorScheme]="'scheme05'">
          </jqxChart>
   </div>
   <div *ngIf="lapInfos.show"
          [style.top.px]='winInfos.y'
          [style.left.px]='winInfos.x'
          [style.width.px]='winInfos.width'
          [style.height.px]='winInfos.height'
          (mousedown)='winInfos.onWindowPress($event,1)'
          (mousemove)='winInfos.onWindowDrag($event,1)'
          class='win'>
        <div (mousedown)='winInfos.onCornerClick($event, winInfos.topLeftResize)' id='win-top-left-resize' class='win-corner-resize'></div>    
        <div (mousedown)='winInfos.onCornerClick($event, winInfos.topRightResize)' id='win-top-right-resize' class='win-corner-resize'></div>    
        <div (mousedown)='winInfos.onCornerClick($event, winInfos.bottomLeftResize)' id='win-bottom-left-resize' class='win-corner-resize'></div>    
        <div (mousedown)='winInfos.onCornerClick($event, winInfos.bottomRightResize)' id='win-bottom-right-resize' class='win-corner-resize'></div> 
      <div id='infos' >
        <table mat-table [dataSource]="infosData" class="mat-elevation-z8">
          <ng-container matColumnDef="title">
            <td mat-cell *matCellDef="let element"> {{element.title}} </td>
          </ng-container>
          <ng-container matColumnDef="value">
            <td mat-cell *matCellDef="let element"> {{element.value}} </td>
          </ng-container>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table> 
      </div>
    </div>
</div>





